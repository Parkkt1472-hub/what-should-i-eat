# 🎯 이색맛집 알고리즘 희귀도 기반 개선

## 📅 업데이트: 2026-02-20

---

## 🎨 변경 전/후 비교

### ❌ **이전 방식**
- **기준**: 이색적인 메뉴 (외국 음식) + 전문점 키워드
- **문제점**:
  - 거리가 먼 곳이 많이 나옴
  - "이색적" 기준이 모호함 (일식/중식도 이색?)
  - 평범한 음식도 전문점이면 높은 점수
  
### ✅ **새로운 방식**
- **기준**: **"사람들이 잘 먹지 않는 음식"** 우선
- **핵심**: 음식 자체의 희귀도를 0~100점으로 수치화
- **효과**:
  - 김치찌개 → 10점 (매우 흔함) → 후순위
  - 추어탕 → 80점 (희귀함) → 최우선
  - 양고기 요리 → 95점 (매우 희귀) → 초우선

---

## 🌟 희귀도 점수 시스템

### 🔴 **매우 흔한 음식 (10점)**
```
한식: 김치찌개, 된장찌개, 순두부찌개, 부대찌개, 비빔밥, 제육볶음, 불고기, 삼겹살, 갈비
분식: 떡볶이, 김밥, 라면, 순대, 튀김
치킨: 치킨, 후라이드, 양념치킨
피자: 피자, 페퍼로니
중식: 짜장면, 짬뽕, 탕수육, 깐풍기
일식: 돈까스, 우동
패스트푸드: 햄버거, 감자튀김
```

### 🟡 **보통 희귀 (50점)**
```
양식: 파스타, 스테이크, 리소토
일식: 초밥, 사시미, 라멘, 소바, 덮밥
베트남: 쌀국수, 월남쌈
동남아: 팟타이
중식: 마라탕, 훠궈
```

### 🟢 **희귀한 음식 (80점)**
```
특수 한식:
  - 곱창/막창/대창
  - 추어탕, 복어, 장어, 아귀
  - 족발, 보쌈, 순대국, 뼈해장국
  - 홍어, 간장게장, 양념게장, 꽃게탕, 대게
  - 전복죽, 해삼, 멍게, 성게

특수 외국 음식:
  - 멕시칸: 타코, 부리또, 퀘사디아, 나초스
  - 인도: 탄두리, 난, 커리, 비리야니
  - 중동: 케밥, 샤와르마, 팔라펠
  - 베트남: 분짜, 반쎄오, 짜조
```

### 🔵 **매우 희귀한 음식 (95점)**
```
특수 육류: 양고기, 램, 염소, 사슴, 악어, 캥거루, 타조
특수 국가 요리: 에티오피아, 페루, 모로코, 그리스, 조지아, 우즈벡, 카자흐
```

### ⚪ **기타 (60점)**
```
위 카테고리에 속하지 않는 모든 음식
```

---

## 📊 최종 점수 계산 공식

```
최종 점수 = 희귀도 점수 + 키워드 점수 + 카테고리 점수 - 감점

1. 희귀도 점수 (0~50점) ⭐ 가장 중요
   - menuRarity × 0.5
   - 예: 추어탕(80점) → 40점

2. 키워드 점수 (8~20점)
   - 전문점/정통/본격: 20점
   - 숨은맛집/현지맛집/독특한/희귀한: 15점
   - 특별한: 12점
   - 유명한/맛집: 10점
   - 기타: 8점

3. 가산점
   - 전문점 키워드: +12점
   - 정통/본격 키워드: +10점
   - 원조/본점 키워드: +8점
   - 희귀 카테고리: +15점
   - 품질 키워드: +2~3점

4. 감점
   - 체인점: -100점 (완전 배제)
   - 지점 패턴: -8점
   - 광고성 키워드: -5점
   - 흔한 카테고리: -10점
```

---

## ✨ 검색 키워드 변경

### **새로운 키워드 우선순위**
```typescript
const ADVENTURE_KEYWORDS = [
  '전문점',      // 1순위 (20점)
  '정통',        // 1순위 (20점)
  '본격',        // 1순위 (20점)
  '숨은맛집',    // 2순위 (15점)
  '현지맛집',    // 2순위 (15점)
  '독특한',      // 2순위 (15점) ✨ 새로 추가
  '희귀한',      // 2순위 (15점) ✨ 새로 추가
  '특별한',      // 3순위 (12점)
  '맛집',        // 4순위 (10점)
  '유명한',      // 4순위 (10점)
];
```

### **제거된 키워드**
- ❌ "맛있는" (너무 일반적)
- ❌ "인기" (대중적 = 희귀하지 않음)

---

## 🎯 실제 예시

### 예시 1: 김치찌개 검색

**이전 방식:**
- 기본 점수: 8~15점
- 전문점이면: +8점
- 결과: 15~23점 정도

**새로운 방식:**
- 희귀도: 10점 → 5점 (희귀도 가중치)
- 키워드: 8~20점
- 흔한 카테고리 감점: -10점
- **결과: 3~15점 (매우 낮음)** ❌

---

### 예시 2: 추어탕 검색

**이전 방식:**
- 기본 점수: 8~15점
- 한식이므로 보통 점수

**새로운 방식:**
- 희귀도: 80점 → 40점 (희귀도 가중치) ⭐
- 키워드: 8~20점
- 전문점 가산: +12점
- **결과: 60~72점 (매우 높음)** ✅

---

### 예시 3: 타코 전문점

**이전 방식:**
- 외국 음식: +6점
- 전문점: +8점
- 결과: 약 25~30점

**새로운 방식:**
- 희귀도: 80점 → 40점 (희귀도 가중치) ⭐
- 키워드: 20점 (전문점)
- 희귀 카테고리: +15점 (멕시칸)
- 전문점 가산: +12점
- **결과: 87점 (초고점)** ✅

---

### 예시 4: 양고기 레스토랑

**이전 방식:**
- 일반 점수: 10~15점

**새로운 방식:**
- 희귀도: 95점 → 47.5점 (희귀도 가중치) ⭐⭐
- 키워드: 10~20점
- 희귀 카테고리: +15점
- **결과: 72.5~82.5점 (극도로 높음)** ✅✅

---

## 🔍 카테고리 점수 시스템

### ✅ **희귀 카테고리 (+15점)**
```
일식, 이탈리안, 프렌치, 스페인
베트남, 태국, 인도, 중동
멕시칸, 터키, 그리스
퓨전, 이색, 특수
```

### ❌ **흔한 카테고리 (-10점)**
```
한식>찌개, 한식>백반, 한식>국,탕
분식, 치킨, 피자, 패스트푸드
중식>짜장면, 중식>짬뽕
```

---

## 🚫 제외 대상

### **완전 제외 (-100점)**
```
체인점: 롯데리아, 맥도날드, KFC, 버거킹, 맘스터치
         스타벅스, 이디야, 투썸플레이스
         교촌치킨, BBQ, 굽네치킨, bhc
         파리바게뜨, 뚜레쥬르
         CU, GS25, 세븐일레븐
```

### **강력 감점 (-8점)**
```
지점 패턴: "○○점", "○○지점" (단, "전문점"은 예외)
```

### **감점 (-5점)**
```
광고성 키워드: 체험단, 협찬, 이벤트, 무료, 할인
```

---

## 📈 기대 효과

### ✅ **개선된 점**

1. **희귀한 음식 우선 추천**
   - 추어탕, 곱창, 타코 같은 특별한 음식이 상위 노출
   - 평범한 김치찌개/치킨은 하위로 이동

2. **전문점 강력 우대**
   - "전문점" 키워드가 있으면 최대 32점 추가 (20+12)
   - 정통/본격 요리 우대

3. **대중적인 음식 배제**
   - 흔한 한식/치킨/피자는 낮은 점수
   - 대형 체인점 완전 배제

4. **특수 카테고리 보너스**
   - 베트남, 인도, 멕시칸 같은 특수 요리 +15점
   - 에티오피아, 조지아 같은 초희귀 국가 음식 최우선

---

## 🎯 TOP5 추천 로직

```typescript
// 점수 순으로 정렬
.sort((a, b) => b.finalScore - a.finalScore)
.slice(0, 5)
.map((item, index) => ({
  rank: index + 1,
  title: item.title,
  address: item.address,
  category: item.category,
  keyword: item.keyword,
  adventureScore: Math.round(item.finalScore),
  adventureLevel: Math.min(100, Math.round((item.finalScore / 30) * 100)),
  menuRarity: item.menuRarity, // 메뉴 희귀도 표시
}));
```

**adventureLevel 계산:**
- 최종 점수 30점 = 100% (만점)
- 추어탕 전문점: 72점 → 240% → 100% (상한선)
- 김치찌개: 10점 → 33%

---

## 🧪 테스트 권장 사항

### **테스트해야 할 메뉴들:**

1. **흔한 음식 (낮은 점수 기대)**
   - 김치찌개 → 10~15점
   - 치킨 → 5~10점
   - 짜장면 → 10~15점

2. **희귀한 음식 (높은 점수 기대)**
   - 추어탕 → 60~75점
   - 곱창 → 60~75점
   - 타코 → 70~85점

3. **매우 희귀한 음식 (초고점 기대)**
   - 양고기 → 75~90점
   - 에티오피아 요리 → 80~95점
   - 캥거루 고기 → 85~95점

---

## 📝 코드 변경 위치

**파일**: `app/api/adventure/route.ts`

**주요 변경 함수:**
1. `COMMON_FOODS` - 흔한 음식 리스트 확장
2. `calculateRarityScore()` - 새로 추가 (희귀도 계산)
3. `ADVENTURE_KEYWORDS` - 키워드 우선순위 변경
4. `calculateAdventureScore()` - 점수 계산 로직 전면 개편
5. `sortedResults` - 정렬 및 반환 로직 개선

---

## 🚀 배포 정보

- **커밋**: `64a5a39` - feat: 이색맛집 알고리즘 희귀도 기반으로 대폭 개선
- **푸시 완료**: 2026-02-20
- **Vercel 자동 배포**: 진행 중
- **배포 URL**: https://what-should-i-eat-red.vercel.app

---

## 💡 향후 개선 방향

1. **사용자 피드백 수집**
   - 실제 추천 결과가 만족스러운지 확인
   - TOP5 중 몇 개가 실제로 "희귀한" 음식인지 통계

2. **희귀도 점수 조정**
   - 사용자 반응에 따라 카테고리별 점수 미세 조정
   - 특정 지역 특성 반영 (예: 부산에서 돼지국밥은 흔함)

3. **머신러닝 적용 고려**
   - 사용자 클릭 데이터 수집
   - 실제로 "이색적"이라고 느끼는 음식 학습

4. **지역별 희귀도 차등 적용**
   - 서울에서 돼지국밥 = 보통 (50점)
   - 부산에서 돼지국밥 = 흔함 (10점)

---

## ✅ 체크리스트

- [x] 희귀도 점수 시스템 구현
- [x] 검색 키워드 최적화
- [x] 점수 계산 로직 개선
- [x] 카테고리 가산/감점 시스템
- [x] 체인점 배제 강화
- [x] 코드 커밋 및 푸시
- [x] 문서화 작성
- [ ] 실제 테스트 및 검증
- [ ] 사용자 피드백 수집
- [ ] 점수 미세 조정

---

**작성일**: 2026-02-20  
**작성자**: Claude AI  
**문서 버전**: 1.0
